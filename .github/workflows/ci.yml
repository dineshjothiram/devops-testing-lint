name: CI


on:
push:
branches: ["main", "master"]
pull_request:
branches: ["main", "master"]


jobs:
test-and-lint:
runs-on: ubuntu-latest
strategy:
matrix:
python-version: [3.10, 3.11]
steps:
- name: Checkout
uses: actions/checkout@v4


- name: Set up Python
uses: actions/setup-python@v4
with:
python-version: ${{ matrix.python-version }}


- name: Cache pip
uses: actions/cache@v4
with:
path: ~/.cache/pip
key: ${{ runner.os }}-pip-${{ hashFiles('**/requirements-dev.txt') }}


- name: Install dependencies
run: |
python -m pip install --upgrade pip
pip install -r requirements-dev.txt


- name: Run isort (check)
run: isort --check-only myapp tests


- name: Run black (check)
run: black --check myapp tests


- name: Run flake8
run: flake8 myapp tests


- name: Run tests
run: pytest -q
